<!--
This file is part of fareshares-pricelist a simple nodejs web application to 
manage the pricelist of a food coop.

Copyright (C) 2022 Enrico Costanza e.costanza@ieee.org

This program is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option)
any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
more details.

You should have received a copy of the GNU General Public License along with
this program. If not, see <http://www.gnu.org/licenses/>.
-->

{% extends "base.html" %}

{% block navbar %}

    {% if interactive %}
    {{ super() }}
    {% endif %}
{% endblock %}

{% block content %}

    <!-- Modal -->
    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="confirmDeleteModalLabel">Are you sure?</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Do you really want to delete this entry?
          </div>
          <div class="modal-footer">
            <button type="button" id="cancelDeleteButton" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" id="confirmDeleteButton" class="btn btn-primary">Delete Entry</button>
          </div>
        </div>
      </div>
    </div>

      <table class="table">
        <thead>
        <td>Category</td>
        <td>Infinity</td>
        <td>Suma</td>
        <td>Brand</td>
        <td>Description</td>
        <td>Organic</td>
        <td>Pack Size</td>
        <td>Infinity Price</td>
        <td>Suma Price</td>
        <td>Pref. Supplier</td>
        <td>VAT</td>
        <td>Prev Fareshares Price</td>
        <td><b>Fareshares Price</b></td>
        {% if interactive %}
        <td>&nbsp;</td>
        {% endif %}
        </thead>

      {% for e in entries %}
        <tr data-dbid="{{ e.id }}" class="entry">
        <td>{{ e.category.name }}</td>
        <td>{{ e.infinity }}</td>
        <td>{{ e.suma }}</td>
        <td>{{ e.brand }}</td>
        <td>
        {% if e.infinity_desc %}
        {{ e.infinity_desc }}
        {% else %}
        {{ e.suma_desc }}
        {% endif %}
        </td>
        <td>
        {{ e.organic }}
        </td>
        <td>
        {{ e.n_items }} x {{ e.item_size }} {{ e.item_unit }}
        </td>
        <td>
        {{ e.infinity_price }}
        </td>
        <td>
        {{ e.suma_price }}
        </td>
        <td class="preferred_supplier">
        {% if interactive %}
        <select class="form-select-sm preferred_supplier" aria-label="Default select example">
        {% for option in [
          {'value': "null", "label": ""}, 
          {'value': "suma", "label": "Suma"}, 
          {'value': "infinity", "label": "Infinity"}] %}
            <option value="{{ option.value }}"
            {% if option.value === e.preferred_supplier %}
            selected
            {% endif %}
            >
            {{ option.label }}
            </option>
        {% endfor %}
        </select>
        {% else %}
        {{ e.preferred_supplier | replace("null", "")}}
        {% endif %}
        </td>
        <td>
        {{ e.vat }}
        </td>
        <td>
        {{ e.prev_fareshares_price.toFixed(2) if e.prev_fareshares_price else "" }}
        </td>
        <td class="fareshares_price">
        <b>{{ e.fareshares_price.toFixed(2) }}</b>
        </td>
        </tr>
      {% endfor %}
      </table>

{% endblock %}


{% block js %}
    {% if interactive %}
    <script type="text/javascript" src="/static/js/libs/d3.v6.min.js"></script>
    <script type="text/javascript" src="/static/js/index.js"></script>
    {% endif %}

{% endblock %}
